#ifndef AC_CORE_MODEL_ACNET_HPP
#define AC_CORE_MODEL_ACNET_HPP

#include <cstddef>

#include "AC/Core/Model/Base.hpp"

#include "ACCoreExport.hpp" // Generated by CMake

namespace ac::core::model
{
    class ACNet;
}

class ac::core::model::ACNet
{
public:
    enum class Variant
    {
        GAN,
        HDN0,
        HDN1,
        HDN2,
        HDN3
    };

public:
    AC_CORE_EXPORT ACNet(Variant v) noexcept;

public:
    // length in numbers
    static constexpr int kernelLength() noexcept { return 8 * 9 + 8 * 8 * 9 * 8 + 8 * 4; }
    static constexpr int biasLength() noexcept { return 8 * 9; }
    static constexpr int kernelLength(const int idx) noexcept { return (idx == 0) ? 8 * 9 : ((idx > 0 && idx < 9) ? 8 * 8 * 9 : ((idx == 9) ? 8 * 4 : 0)); }
    static constexpr int biasLength(const int idx) noexcept { return (idx >= 0 && idx < 9) ? 8 : 0; }
    // size in bytes
    static constexpr std::size_t kernelSize() noexcept { return kernelLength() * sizeof(float); }
    static constexpr std::size_t biasSize() noexcept { return biasLength() * sizeof(float); }
    static constexpr std::size_t kernelSize(const int idx) noexcept { return kernelLength(idx) * sizeof(float); }
    static constexpr std::size_t biasSize(const int idx) noexcept { return biasLength(idx) * sizeof(float); }

    static constexpr int kernels() { return 10; }
    static constexpr int biases() { return 9; }

    static constexpr int kernelOffset(const int idx) noexcept
    {
        int offset = 0;
        for(int i = 0; i < idx; i++)
            offset += kernelLength(i);
        return offset;
    }
    static constexpr int biasOffset(const int idx) noexcept
    {
        int offset = 0;
        for(int i = 0; i < idx; i++)
            offset += biasLength(i);
        return offset;
    }

    const float* kernel(const int idx = 0) const noexcept { return kptr + kernelOffset(idx); }
    const float* bias(const int idx = 0) const noexcept { return bptr + biasOffset(idx); }

private:
    const float* kptr;
    const float* bptr;
};

#endif
